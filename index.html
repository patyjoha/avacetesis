<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Avance de Tesis - SINAP XII</title>
    <!-- Chosen Palette: Neutral Grays with a Green accent for progress -->
    <!-- Application Structure Plan: A single-page dashboard featuring a master progress bar and collapsible sections (accordions) for each phase of the thesis project. This structure was chosen to provide a clear overview while preventing information overload. Users can focus on one phase at a time. State is saved in localStorage for persistence. This task-oriented design is more interactive and functional than a static table. -->
    <!-- Visualization & Content Choices: Report Info: Project checklist -> Goal: Track progress -> Viz/Presentation Method: Interactive checkboxes, dynamic progress bar, textareas for notes -> Interaction: Clicking checkboxes updates the progress bar; typing in textareas saves notes. -> Justification: This provides immediate visual feedback and turns a static document into a practical project management tool. -> Library/Method: Vanilla JS for interactivity and state management, Tailwind CSS for styling. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .task-content {
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        .task-content.open {
            max-height: 2000px; /* Large enough to fit content */
            opacity: 1;
        }
        .section-toggle-icon {
            transition: transform 0.3s ease-in-out;
        }
        .open .section-toggle-icon {
            transform: rotate(90deg);
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <main class="max-w-4xl mx-auto bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200">
        
        <header class="text-center border-b border-slate-200 pb-6 mb-6">
            <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">Proyecto de Tesis SINAP XII</h1>
            <p class="text-slate-500 mt-2">Lista de Verificación de Avance Interactivo</p>
        </header>

        <section id="progress-section" class="mb-8">
            <h2 class="text-lg font-semibold text-slate-700 mb-2">Progreso General del Proyecto</h2>
            <div class="w-full bg-slate-200 rounded-full h-5">
                <div id="progressBar" class="bg-emerald-500 h-5 rounded-full text-center text-white text-xs font-bold leading-5 transition-all duration-500" style="width: 0%">0%</div>
            </div>
        </section>

        <div id="checklist-container" class="space-y-4">
            
            <!-- SECCIÓN 1 -->
            <div class="border border-slate-200 rounded-lg">
                <button class="section-toggle w-full flex justify-between items-center text-left p-4 bg-slate-50 hover:bg-slate-100 rounded-t-lg transition">
                    <h3 class="font-semibold text-lg text-slate-700">1. Elaboración del Anteproyecto</h3>
                    <span class="section-toggle-icon text-slate-500">▶</span>
                </button>
                <div class="task-content">
                    <div class="p-4 space-y-3">
                        <p class="text-sm text-slate-600 mb-4">Evaluar la organización, establecer objetivos y definir la visión del negocio. Esta fase sienta las bases del proyecto, asegurando el alineamiento con los stakeholders y definiendo los criterios de éxito desde el inicio.</p>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-1-1" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-1-1" class="flex-1">
                                <span class="font-medium text-slate-800">Reuniones iniciales con stakeholders</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-1-2" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-1-2" class="flex-1">
                                <span class="font-medium text-slate-800">Documentación de misión, visión y estructura</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-1-3" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-1-3" class="flex-1">
                                <span class="font-medium text-slate-800">Definición de objetivos y roles</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-1-4" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-1-4" class="flex-1">
                                <span class="font-medium text-slate-800">Creación de artefactos iniciales (informe, glosario)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 2 -->
            <div class="border border-slate-200 rounded-lg">
                <button class="section-toggle w-full flex justify-between items-center text-left p-4 bg-slate-50 hover:bg-slate-100 rounded-t-lg transition">
                    <h3 class="font-semibold text-lg text-slate-700">2. Relevamiento de Datos</h3>
                    <span class="section-toggle-icon text-slate-500">▶</span>
                </button>
                <div class="task-content">
                    <div class="p-4 space-y-3">
                        <p class="text-sm text-slate-600 mb-4">Comprender los procesos actuales y obtener los datos necesarios. Se recolecta información detallada de cada área a través de entrevistas, observación y análisis de documentación para mapear los flujos existentes.</p>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-2-1" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-2-1" class="flex-1">
                                <span class="font-medium text-slate-800">Identificación y programación de entrevistas</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-2-2" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-2-2" class="flex-1">
                                <span class="font-medium text-slate-800">Recopilación de documentación existente</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-2-3" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-2-3" class="flex-1">
                                <span class="font-medium text-slate-800">Observación y mapeo de flujos actuales</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-2-4" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-2-4" class="flex-1">
                                <span class="font-medium text-slate-800">Elaboración de diagramas y matrices de datos</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 3 -->
            <div class="border border-slate-200 rounded-lg">
                <button class="section-toggle w-full flex justify-between items-center text-left p-4 bg-slate-50 hover:bg-slate-100 rounded-t-lg transition">
                    <h3 class="font-semibold text-lg text-slate-700">3. Identificación y Análisis de Problemas</h3>
                    <span class="section-toggle-icon text-slate-500">▶</span>
                </button>
                <div class="task-content">
                     <div class="p-4 space-y-3">
                        <p class="text-sm text-slate-600 mb-4">Descomponer y analizar los problemas detectados en los procesos actuales. Se utiliza un enfoque participativo para determinar el problema central, sus causas raíz y sus efectos, priorizando los más críticos.</p>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-3-1" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-3-1" class="flex-1">
                                <span class="font-medium text-slate-800">Listado de problemas identificados</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-3-2" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-3-2" class="flex-1">
                                <span class="font-medium text-slate-800">Análisis de causa-efecto (Diagrama de Ishikawa)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-3-3" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-3-3" class="flex-1">
                                <span class="font-medium text-slate-800">Evaluación de impacto y priorización de problemas</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-3-4" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-3-4" class="flex-1">
                                <span class="font-medium text-slate-800">Validación del análisis con stakeholders</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 4 -->
            <div class="border border-slate-200 rounded-lg">
                <button class="section-toggle w-full flex justify-between items-center text-left p-4 bg-slate-50 hover:bg-slate-100 rounded-t-lg transition">
                    <h3 class="font-semibold text-lg text-slate-700">4. Definición de Objetivos y Alcance</h3>
                    <span class="section-toggle-icon text-slate-500">▶</span>
                </button>
                <div class="task-content">
                    <div class="p-4 space-y-3">
                        <p class="text-sm text-slate-600 mb-4">Formular los objetivos del proyecto y delimitar su alcance. Se definen metas SMART alineadas con el negocio y se establecen claramente las funcionalidades incluidas y excluidas para evitar desviaciones.</p>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-4-1" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-4-1" class="flex-1">
                                <span class="font-medium text-slate-800">Formulación de objetivos (general y específicos)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-4-2" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-4-2" class="flex-1">
                                <span class="font-medium text-slate-800">Definición de contenido, exclusiones y supuestos</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-4-3" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-4-3" class="flex-1">
                                <span class="font-medium text-slate-800">Redacción del enunciado de alcance</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 5 -->
            <div class="border border-slate-200 rounded-lg">
                <button class="section-toggle w-full flex justify-between items-center text-left p-4 bg-slate-50 hover:bg-slate-100 rounded-t-lg transition">
                    <h3 class="font-semibold text-lg text-slate-700">5. Estudio de Alternativas de Solución</h3>
                    <span class="section-toggle-icon text-slate-500">▶</span>
                </button>
                <div class="task-content">
                    <div class="p-4 space-y-3">
                        <p class="text-sm text-slate-600 mb-4">Analizar diversas soluciones posibles. Se realiza un estudio comparativo evaluando ventajas, desventajas, viabilidad y costos para seleccionar la alternativa óptima de forma justificada.</p>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-5-1" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-5-1" class="flex-1">
                                <span class="font-medium text-slate-800">Generación de opciones de solución</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-5-2" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-5-2" class="flex-1">
                                <span class="font-medium text-slate-800">Análisis comparativo y filtrado de alternativas</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-5-3" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-5-3" class="flex-1">
                                <span class="font-medium text-slate-800">Selección y justificación de la solución preferida</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 6 -->
            <div class="border border-slate-200 rounded-lg">
                <button class="section-toggle w-full flex justify-between items-center text-left p-4 bg-slate-50 hover:bg-slate-100 rounded-t-lg transition">
                    <h3 class="font-semibold text-lg text-slate-700">6. Estimación y Planificación</h3>
                    <span class="section-toggle-icon text-slate-500">▶</span>
                </button>
                <div class="task-content">
                    <div class="p-4 space-y-3">
                        <p class="text-sm text-slate-600 mb-4">Estimar los recursos, plazos y costos necesarios para la ejecución del proyecto. Se elabora un plan de trabajo detallado con fases, iteraciones, actividades, responsables y entregables.</p>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-6-1" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-6-1" class="flex-1">
                                <span class="font-medium text-slate-800">Identificación y priorización de requerimientos (casos de uso)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-6-2" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-6-2" class="flex-1">
                                <span class="font-medium text-slate-800">Estimación de recursos (humanos, tecnológicos) y esfuerzo</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-6-3" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-6-3" class="flex-1">
                                <span class="font-medium text-slate-800">Elaboración del plan de trabajo (Plan de Desarrollo)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 7 -->
            <div class="border border-slate-200 rounded-lg">
                <button class="section-toggle w-full flex justify-between items-center text-left p-4 bg-slate-50 hover:bg-slate-100 rounded-t-lg transition">
                    <h3 class="font-semibold text-lg text-slate-700">7. Análisis y Diseño (Proceso Unificado RUP)</h3>
                    <span class="section-toggle-icon text-slate-500">▶</span>
                </button>
                <div class="task-content">
                    <div class="p-4 space-y-3">
                        <p class="text-sm text-slate-600 mb-4">Aplicar el Proceso Unificado de Rational (RUP) para el análisis y diseño orientado a objetos. Se crean los modelos de análisis y diseño a partir de los casos de uso para definir la arquitectura y estructura del sistema.</p>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-7-1" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-7-1" class="flex-1">
                                <span class="font-medium text-slate-800">Creación del Modelo de Negocio (dominio del problema)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-7-2" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-7-2" class="flex-1">
                                <span class="font-medium text-slate-800">Desarrollo del Modelo de Análisis (clases del dominio)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-7-3" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-7-3" class="flex-1">
                                <span class="font-medium text-slate-800">Desarrollo del Modelo de Diseño (clases implementables)</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                        <div class="task-item flex items-start space-x-3 p-3 border-t border-slate-100">
                            <input type="checkbox" id="task-7-4" class="mt-1 h-5 w-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="task-7-4" class="flex-1">
                                <span class="font-medium text-slate-800">Definición de la arquitectura base y otros diagramas</span>
                                <textarea placeholder="Añadir observaciones o fecha..." class="w-full mt-2 p-2 text-sm border border-slate-300 rounded-md focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const checklistContainer = document.getElementById('checklist-container');
            const allCheckboxes = checklistContainer.querySelectorAll('input[type="checkbox"]');
            const progressBar = document.getElementById('progressBar');
            const storageKey = 'tesisChecklistState';

            function updateProgress() {
                const checkedCount = Array.from(allCheckboxes).filter(cb => cb.checked).length;
                const totalCount = allCheckboxes.length;
                const percentage = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;
                progressBar.style.width = `${percentage}%`;
                progressBar.textContent = `${percentage}%`;
            }

            function saveState() {
                const state = {};
                allCheckboxes.forEach(checkbox => {
                    const notesTextarea = checkbox.closest('.task-item').querySelector('textarea');
                    state[checkbox.id] = {
                        checked: checkbox.checked,
                        notes: notesTextarea ? notesTextarea.value : ''
                    };
                });
                localStorage.setItem(storageKey, JSON.stringify(state));
            }

            function loadState() {
                const savedState = JSON.parse(localStorage.getItem(storageKey));
                if (savedState) {
                    allCheckboxes.forEach(checkbox => {
                        if (savedState[checkbox.id]) {
                            checkbox.checked = savedState[checkbox.id].checked;
                            const notesTextarea = checkbox.closest('.task-item').querySelector('textarea');
                            if (notesTextarea) {
                                notesTextarea.value = savedState[checkbox.id].notes;
                            }
                        }
                    });
                }
            }

            checklistContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('section-toggle')) {
                    const content = e.target.nextElementSibling;
                    const parent = e.target.parentElement;
                    parent.classList.toggle('open');
                    content.classList.toggle('open');
                }
            });

            checklistContainer.addEventListener('change', (e) => {
                if (e.target.type === 'checkbox') {
                    updateProgress();
                    saveState();
                }
            });
            
            checklistContainer.addEventListener('input', (e) => {
                if (e.target.tagName.toLowerCase() === 'textarea') {
                    saveState();
                }
            });

            loadState();
            updateProgress();
        });
    </script>
</body>
</html>
